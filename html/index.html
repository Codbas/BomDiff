<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bom Diff</title>
    <link id="favicon" rel="shortcut icon" type="image/png" href="data:image/png;base64,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">
    <script>
    "use strict";
    let file1 = null;
    let file2 = null;
    const dragCounters = new Map();
    let timeoutId = null;


    window.addEventListener("load", ()=> {
        const dropContainers = document.getElementsByClassName("drop-container");
        const removeFileButtons = document.getElementsByClassName("remove-file");
        const uploadInputs = document.getElementsByTagName("input");
        const submitButton = document.getElementById("getDiffButton");

        for (let elem of removeFileButtons) {
            elem.addEventListener("click", removeFile);
        }

        for (let elem of dropContainers) {
            elem.addEventListener("dragenter", handleDragEnter);
            elem.addEventListener("dragleave", handleDragLeave);
            elem.addEventListener("drop", dropHandler);
            elem.addEventListener("dragover", handleDragOver);
        }

        for (let elem of uploadInputs) {
            elem.addEventListener("change", handleFileUpload);
        }

        submitButton.addEventListener("click", compareBoms);

        document.body.addEventListener("dragover", handleDragOver);
        document.body.addEventListener("drop", (event) => {
            event.preventDefault();
        });
    });



    /********************************************************************
     * 
     *                      Event Listeners
     * 
    *********************************************************************/

    async function compareBoms(event) {
        if (event.target.classList[0] === "disabled") {
            return;
        }

        const tableWrapper = document.getElementById("table-wrapper");
        tableWrapper.innerHTML = "";
        tableWrapper.classList.remove("empty");
        tableWrapper.classList.add("populated");

        const bom1 = await csvToArray(file1);
        const bom2 = await csvToArray(file2);

        const diff = getBomDiff(bom1, bom2);

        // If diff is empty show message & return
        if (diff.length === 1) {
            // array is empty
            tableWrapper.innerText = "BOMs are identical";
            return;
        }

        const table = arrayToTable(diff);

        tableWrapper.innerHTML = table;
    }

    function removeFile(event) {
        clearTimeout(timeoutId);

        const container = event.currentTarget.parentElement;
        const submitButton = document.getElementById("getDiffButton");
        container.classList.remove("dropped");
        container.classList.remove("error");
        container.getElementsByTagName("p")[0].innerText = "Drag & Drop";

        clearFileContents(container);

        submitButton.classList.add("disabled");
    }

    function handleFileUpload(event) {
        clearTimeout(timeoutId);

        const container = event.currentTarget.parentElement;
        const submitButton = document.getElementById("getDiffButton");

        const file = event.target.files[0];

        if (!isCSV(file.name)) {
            displayInvalidFileError(container, file.name);
            clearFileContents(container);
            submitButton.classList.add("disabled");
            return;
        }

        setFileContents(container, file);
        updateContainer(container, file.name);

        if (file1 !== null && file2 !== null) {
            submitButton.classList.remove("disabled");
        }
    }

    function dropHandler(event) {
        event.preventDefault();
        clearTimeout(timeoutId);

        const container = event.currentTarget;
        const submitButton = document.getElementById("getDiffButton");
        
        dragCounters.set(container, 0); 
        container.classList.remove("drag-over");

        const file = event.dataTransfer.items[0].getAsFile();

        if (!isCSV(file.name)) {
            displayInvalidFileError(container, file.name);
            clearFileContents(container);
            submitButton.classList.add("disabled");
            return;
        }

        setFileContents(container, file);
        updateContainer(container, file.name);

        if (file1 !== null && file2 !== null) {
            submitButton.classList.remove("disabled");
        }
    }

    function handleDragEnter(event) {
        event.preventDefault();

        const container = event.currentTarget;
        const count = dragCounters.get(container) || 0;
        dragCounters.set(container, count + 1);

        if (count === 0) {
            container.classList.add("drag-over");
        }
    }

    function handleDragLeave(event) {
        event.preventDefault();

        const container = event.currentTarget;
        const count = dragCounters.get(container) || 0;

        if (count <= 1) {
            dragCounters.set(container, 0);
            container.classList.remove("drag-over");
        } else {
            dragCounters.set(container, count - 1);
        }
    }

    function handleDragOver(event) {
        event.preventDefault(); 
    }



    /********************************************************************
     * 
     *              File upload, DOM update, file validation
     * 
    *********************************************************************/

    function setFileContents(container, file) {
        if (container.id !== "dropContainer1" && container.id !== "dropContainer2") {
            console.log("Error: " + container.id + " is not a valid container");
            return;
        }

        if (container.id === "dropContainer1") {
            file1 = file;
        }
        else {
            file2 = file;
        }
    }

    function updateContainer(container, fileName) {
        if (isCSV(fileName)) {
            container.classList.add("dropped");
            container.classList.remove("error");
            container.getElementsByTagName("p")[0].innerText = fileName;
        }
        else {
            container.classList.remove("dropped");
            container.classList.add("error");
            container.getElementsByTagName("p")[0].innerText = "Error: Not a CSV";
        }
    }

    function displayInvalidFileError(container, fileName) {
        updateContainer(container, fileName);

        timeoutId = setTimeout(() => {
            container.classList.remove("error");
            container.getElementsByTagName("p")[0].innerText = "Drag & Drop";
        }, 5000);
    }

    async function csvToString(csv) {
        const text = await csv.text();
        return text;
    }

    function clearFileContents(container) {
        if (container.id === "dropContainer1") {
            file1 = null
        }
        else {
            file2 = null
        }
    }

    function isCSV(fileName) {
        if (fileName.toLowerCase().endsWith(".csv")) {
            return true;
        }
        return false;
    }

    async function csvToTable(csv) {
        const text = await csvToString(csv);

        const rows = [];
        let current = '';
        let inQuotes = false;
        let field = '';
        let row = [];

        for (let i = 0; i < text.length; i++) {
            const char = text[i];
            const nextChar = text[i + 1];

        // fields are wrapped in quotes when they contain commas. Keep the commas
        if (inQuotes) {
            if (char === '"' && nextChar === '"') {
                field += '"';
                i++;
            } else if (char === '"') {
                inQuotes = false;
            } else {
                field += char;
            }
        } else {
            if (char === '"') {
                inQuotes = true;
                } else if (char === ',') {
                    row.push(field);
                    field = '';
                } else if (char === '\n' || char === '\r') {
                    if (field || row.length > 0) {
                        row.push(field);
                        field = '';
                        rows.push(row);
                        row = [];
                    }
                    if (char === '\r' && nextChar === '\n') i++;
                } else {
                    field += char;
                }
            }
        }

        if (field || row.length > 0) {
            row.push(field);
            rows.push(row);
        }

        if (rows.length === 0) return '';

        const headers = rows[0];
        const dataRows = rows.slice(1);

        let table = '<table><thead><tr>';
        headers.forEach(header => {
            table += `<th>${header}</th>`;
        });
        table += '</tr></thead><tbody>';

        dataRows.forEach(row => {
            table += '<tr>';
            row.forEach(cell => {
                table += `<td>${cell}</td>`;
            });
            table += '</tr>';
        });

        table += '</tbody></table>';

        return table;
    }

    async function csvToArray(csv) {
        const text = await csvToString(csv);

        const rows = [];
        let inQuotes = false;
        let field = '';
        let row = [];

        for (let i = 0; i < text.length; i++) {
            const char = text[i];
            const nextChar = text[i + 1];

            // fields are wrapped in quotes when they contain commas. Keep the commas
            if (inQuotes) {
                if (char === '"' && nextChar === '"') {
                    field += '"'; 
                    i++;
                } else if (char === '"') {
                    inQuotes = false;
                } else {
                    field += char;
                }
            } else {
                if (char === '"') {
                    inQuotes = true;
                } else if (char === ',') {
                    row.push(field);
                    field = '';
                } else if (char === '\n' || char === '\r') {
                    if (field || row.length > 0) {
                        row.push(field);
                        field = '';
                        rows.push(row);
                        row = [];
                    }
                    if (char === '\r' && nextChar === '\n') i++;
                } else {
                    field += char;
                }
            }
        }

        if (field || row.length > 0) {
            row.push(field);
            rows.push(row);
        }

        return rows;
    }

    function JSONToTable(json) {
        let headers = Object.keys(jsonData[0]);
        let table = "<table><thead><tr>";

        headers.forEach(header => table += `<th>${header}</th>`);
        table += `</tr></thead><tbody>`;

        json.forEach(row => {
            table += "<tr>";
            headers.forEach(header => table += `<td>${row[header]}</td>`);
            table += "<tr>";
        });

        table += "</tbody></table>";

        return table;
    }

    function getIndexOfString(stringArr, arr) {
      for (let i = 0; i < arr.length; i++) {
            if (stringArr.includes(arr[i].toLowerCase())) {
                return i;
            }
        }

        return -1;
    }

    function arrayToTable(arr) {
        let table = "<table border='1'><thead><tr>";

        for (let i = 0; i < arr[0].length; i++) {
            table += `<th>${arr[0][i]}</th>`;
        }

        table += "</tr></thead><tbody>";

        for (let i = 1; i < arr.length; i++) {
            table += "<tr>";
            for (let j = 0; j < arr[i].length; j++) {
                table += `<td>${arr[i][j]}</td>`;
            }
            table += "</tr>";
        }

        table += "</tbody></table>";

    return table;
    }


    /********************************************************************
     * 
     *                      Compare BOMs logic
     * 
    *********************************************************************/
    

    function getBomDiff(bom1, bom2) {
        let diff = [["Item", "Quantity"]];

        // item and qty columns have multiple possible names
        const itemStrings = ["item", "component name"];
        const qtyStrings = ["quantity", "quantity per assembly"];

        const bom1ItemIndex = getIndexOfString(itemStrings, bom1[0]);
        const bom1QtyIndex = getIndexOfString(qtyStrings, bom1[0]);
        const bom2ItemIndex = getIndexOfString(itemStrings, bom2[0]);
        const bom2QtyIndex = getIndexOfString(qtyStrings, bom2[0]);
        
        if (bom1ItemIndex === -1 || bom1QtyIndex === -1 || bom2ItemIndex === -1 || bom2QtyIndex === -1) {
            console.log("Error finding Item or Qty colums");
            return diff;
        }

        // iterate through all lines on first bom
        for (let i = 1; i < bom1.length; i++) {
            let matched = false;
            const item1 = bom1[i][bom1ItemIndex];
            const qty1 = parseFloat(bom1[i][bom1QtyIndex]);

            // iterate through all lines on second bom in reverse
            for (let j = bom2.length - 1; j >= 1; j--) {
                const item2 = bom2[j][bom2ItemIndex];
                const qty2 = parseFloat(bom2[j][bom2QtyIndex]);
                
                // if item found
                if (item1 === item2) {
                    matched = true;
                    if (qty1 === qty2) {
                    }
                    else {
                        diff.push([item1, qty1 - qty2]);
                    }
                    bom2.splice(j, 1);
                    break;
                }
            }

            // if not found, add negative qty of item to diff
            if (!matched) {
                diff.push([item1, -qty1]);
            }
        }

        // Add remaining items from bom2 to diff
        for (let i = 1; i < bom2.length; i++) {
            diff.push([bom2[i][bom2ItemIndex], bom2[i][bom2QtyIndex]]);
        }

        return diff;
    }



    </script>
    <style>
        html {
            height: 100%;
        } body {
            font-family: Helvetica, Arial, serif;
            margin: 0;
            min-height: 100%;
        }
        #instructions {
            margin-top: 0px;
            line-height: 200px;
            text-align: center;
            height: 100px;
            user-select: none;
        }

        #upload-container {
            position: relative;
            margin-top: 50px;
            margin-left: auto;
            margin-right: auto;
            min-width: 400px;
            max-width: 500px;
            height: 150px;
        }

        .error {
            transition: 0.2s;
            background: #da5e5e !important;
        }

        .dropped {
            transition: 0.2s;
            background: #abfcc3 !important;
        }
        .drag-over > .browse-label, .dropped > .browse-label, .error > .browse-label {
            transition: opacity 0.2s;
            opacity: 0;
            visibility: hidden;
        }
        .drag-over {
            background: #97c6ff !important;
        }
        .drag-over > p, .dropped > p, .error > p {
            transition: 0.2s;
            transform: translateY(-12px);
        }
        p , .browse-label {
            user-select: none;
            transition: 0.2s;
        }

        .drop-container {
            transition: 1s;
            padding: 15px;
            width: 150px;
            background: #eee;
            text-align: center;
            border-radius: 5px;
        }

        .browse-label {
            background: #bbb;
            line-height: 25px;
            display: inline-block;
            border-radius: 4px;
            height: 25px;
            width: 100px;
        }
        .browse-label:hover{
            cursor: pointer;
            background: #ddd;
        }

        .drop-container-label {
            text-align: center;
            margin-bottom: 5px;
            user-select: none;
        }
        .drop-wrapper {
            position: relative;
            margin: 10px;
        }
        #drop-wrapper1 {
            float: left;
        }
        #drop-wrapper2 {
            float: right;
        }

        .remove-file {
            width: 20px;
            height: 20px;
            line-height: 20px;
            display: none;
            user-select: none;
            position: absolute;
            right: 5px;
            top: 28px;
        }
        .remove-file:hover {
            cursor: pointer;
            color: red !important;
        }
        .remove-file:active {
            color: black !important;
        }
        .dropped > div, .error > div {
            display: unset;
        }

        .disabled {
            opacity: 0.5 !important;
        }
        #getDiffButton:hover:not(.disabled) {
            cursor: pointer;
            background: #eee;
            transition: 0.2s;
        }
        #getDiffButton {
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            user-select: none;
            line-height: 25px;
            width: 100px;
            height: 25px;
            margin-top: 25px;
            background: #ccc;
            border-radius: 5px;
        }

        #table:not(.empty) {
            display: unset;
        }
        #table:has(.empty) {
            display: none;
        }
        #table {
            text-align: center;
            align-content: center;
        }
        #table-wrapper {
            margin-top: 100px;
            margin-left: 25px;
            margin-right: 25px;

        }

        .empty {
            display: none;
        }
        .populated {
            display: unset;
        }

        table {
            margin-left: auto;
            margin-right: auto;
            border-collapse: collapse;
            border: none;
        }
        th, td {
            border: 1px solid black;
        }
        table th {
            border-top: none;
        }
        th:first-child, td:first-child {
            border-left: none;
        }
        th:last-child, td:last-child {
            border-right: none;
        }
        th {
            border-top: none;
        }
        table tr:last-child td {
            border-bottom: none;
        }

        #wip {
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            color: red;
            user-select: none;
        }
    </style>
</head>


<body>
    <div id="wip">This website is a work in progress. <br>Unexpected errors may occur</div>
    <div id="instructions"> Select BOM CSVs to upload</div>
<div id="upload-container">
    <div class="drop-wrapper" id="drop-wrapper1">
    <div class="drop-container-label">CSV 1</div>
        <div id="dropContainer1" class="drop-container">
            <div class="remove-file" id="removeFile1">X</div>
            <label class="browse-label" for="file1">Browse</label>
            <input type="file" multiple="false" accept=".csv" style="display:none;" id="file1" name="file1">
            <p>Drag & Drop</p>
        </div>
        </div>
        <div class="drop-wrapper" id="drop-wrapper2">
    <div class="drop-container-label">CSV 2</div>
        <div id="dropContainer2" class="drop-container">
            <div class="remove-file" id="removeFile2">X</div>
            <label class="browse-label" for="file2">Browse</label>
            <input type="file" multiple="false" accept=".csv" style="display:none;" id="file2" name="file2">
            <p>Drag & Drop</p>
        </div>
    </div>
</div>
<div id="getDiffButton" class="disabled">Get Diff</div>
<div id="table-wrapper" class="empty">

    
</div>
</body>
</html>